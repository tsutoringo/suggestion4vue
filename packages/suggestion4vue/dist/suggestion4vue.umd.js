(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis<"u"?globalThis:c||self,e(c.suggestion4vue={},c.Vue))})(this,function(c,e){"use strict";const C=()=>{const i=e.reactive(new Map),n=e.ref([]),t=e.ref(!1),o=e.ref(void 0),a=e.ref(void 0),I=(l,x)=>{i.set(l,x)},m=l=>{i.delete(l)},f=(l,x)=>{const v=i.get(l);!v||(v.index=x)},u=()=>{!o.value||o.value.pick()},d=()=>t.value=!0,p=()=>t.value=!1,g=()=>{o.value=o.value?n.value[o.value.index+1]:n.value[0],r()},s=()=>{o.value=o.value?n.value[o.value.index-1]:n.value[n.value.length-1],r()},r=()=>{o.value&&o.value.select()},E=()=>n.value=[],V=l=>{const x=i.get(l);if(!x){console.warn(`Unknown item ${l}`);return}n.value.push(x)},y=l=>{t.value&&a.value&&!a.value.contains(l.target)&&p()};return e.watch(t,l=>l?document.addEventListener("click",y):document.removeEventListener("click",y)),{items:i,indexedItems:n,addItem:I,removeItem:m,setItemIndex:f,openBox:d,closeBox:p,selectedItem:o,selectItem:u,clearIndexedItems:E,addItemToIndexedItems:V,next:g,prev:s,searchBox:a,isOpen:t}},h=Symbol("suggestion"),B=()=>{var n,t;const i=e.inject(h);if(!i)throw new Error(`${((n=e.getCurrentInstance())==null?void 0:n.type.name)||((t=e.getCurrentInstance())==null?void 0:t.type.__name)||"this component"} must be included in the SearchBox.`);return i},k=e.defineComponent({name:"SearchBox",setup(i,{slots:n}){const t=C();e.provide(h,t);const{setItemIndex:o,clearIndexedItems:a,addItemToIndexedItems:I,searchBox:m}=t;return e.watch(t.items,()=>{if(!m.value)return;const f=m.value.getElementsByClassName("suggestion-item");a();for(let u=0;u<f.length;u++){const d=f[u];!d||(o(d,u),I(d))}}),()=>e.h("div",{class:"search-box",ref:m},[e.renderSlot(n,"default")])}}),$={key:0,class:"suggestion-box"},w=e.defineComponent({__name:"SuggestionBox",setup(i){const{isOpen:n}=B();return(t,o)=>e.unref(n)?(e.openBlock(),e.createElementBlock("div",$,[e.renderSlot(t.$slots,"default")])):e.createCommentVNode("",!0)}}),S=e.defineComponent({__name:"SuggestionInput",props:{modelValue:{default:""}},emits:["update:modelValue","enter"],setup(i,{emit:n}){const t=i,{selectedItem:o,openBox:a,closeBox:I,selectItem:m,next:f,prev:u}=B(),d=g=>{o.value||n("enter",g),m()},p=e.computed({get:()=>t.modelValue,set:g=>n("update:modelValue",g)});return(g,s)=>e.withDirectives((e.openBlock(),e.createElementBlock("input",{type:"search",class:"suggestion-input","onUpdate:modelValue":s[0]||(s[0]=r=>e.isRef(p)?p.value=r:null),onKeydown:[s[1]||(s[1]=e.withKeys(e.withModifiers(r=>d(r),["prevent"]),["enter"])),s[2]||(s[2]=e.withKeys(e.withModifiers(r=>e.unref(f)(),["prevent"]),["down"])),s[3]||(s[3]=e.withKeys(e.withModifiers(r=>e.unref(u)(),["prevent"]),["up"])),s[4]||(s[4]=e.withKeys(r=>e.unref(I)(),["tab"]))],onFocus:s[5]||(s[5]=(...r)=>e.unref(a)&&e.unref(a)(...r))},null,544)),[[e.vModelText,e.unref(p)]])}}),M={name:"SuggestionItem"},_=e.defineComponent({...M,emits:["pick","select"],setup(i,{emit:n}){const t=e.ref(null),{addItem:o,removeItem:a,closeBox:I,selectedItem:m}=B();e.getCurrentInstance();const f=()=>{I(),n("pick")},u=()=>{n("select")},d=e.reactive({index:0,pick:f,select:u}),p=e.computed(()=>m.value===d);return e.onMounted(()=>{!t.value||o(t.value,d)}),e.onBeforeUnmount(()=>{!t.value||a(t.value)}),(g,s)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["suggestion-item",{selected:e.unref(p)}]),onClick:s[0]||(s[0]=r=>f()),ref_key:"element",ref:t},[e.renderSlot(g.$slots,"default",{index:d.index})],2))}}),b={SearchBox:k,Input:S,Item:_,Box:w};c.Box=w,c.Input=S,c.Item=_,c.SearchBox=k,c.default=b,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
