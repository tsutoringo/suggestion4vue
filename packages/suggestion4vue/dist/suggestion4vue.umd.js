(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis<"u"?globalThis:c||self,e(c.suggestion4vue={},c.Vue))})(this,function(c,e){"use strict";const $=()=>{const r=e.reactive(new Map),n=e.ref([]),t=e.ref(!1),o=e.ref(void 0),d=e.ref(void 0),g=(l,B)=>{r.set(l,B)},m=l=>{r.delete(l)},f=(l,B)=>{const C=r.get(l);!C||(C.index=B)},a=()=>{!o.value||o.value.pick()},i=()=>t.value=!0,x=()=>t.value=!1,I=()=>{o.value=o.value?n.value[o.value.index+1]:n.value[0],s()},p=()=>{o.value=o.value?n.value[o.value.index-1]:n.value[n.value.length-1],s()},s=()=>{o.value&&o.value.select()},u=()=>n.value=[],V=l=>{const B=r.get(l);if(!B){console.warn(`Unknown item ${l}`);return}n.value.push(B)},v=l=>{t.value&&d.value&&!d.value.contains(l.target)&&x()};return e.watch(t,l=>l?document.addEventListener("click",v):document.removeEventListener("click",v)),{items:r,indexedItems:n,addItem:g,removeItem:m,setItemIndex:f,openBox:i,closeBox:x,selectedItem:o,selectItem:a,clearIndexedItems:u,addItemToIndexedItems:V,next:I,prev:p,searchBox:d,isOpen:t}},k=Symbol("suggestion"),h=()=>{var n,t;const r=e.inject(k);if(!r)throw new Error(`${((n=e.getCurrentInstance())==null?void 0:n.type.name)||((t=e.getCurrentInstance())==null?void 0:t.type.__name)||"this component"} must be included in the SearchBox.`);return r},_=e.defineComponent({name:"SearchBox",setup(r,{slots:n}){const t=$();e.provide(k,t);const{setItemIndex:o,clearIndexedItems:d,addItemToIndexedItems:g,searchBox:m}=t;return e.watch(t.items,()=>{if(!m.value)return;const f=m.value.getElementsByClassName("suggestion-item");d();for(let a=0;a<f.length;a++){const i=f[a];!i||(o(i,a),g(i))}}),()=>e.h("div",{class:"search-box",ref:m},[e.renderSlot(n,"default")])}}),E={key:0,class:"suggestion-box"},w=e.defineComponent({__name:"SuggestionBox",setup(r){const{isOpen:n}=h();return(t,o)=>e.unref(n)?(e.openBlock(),e.createElementBlock("div",E,[e.renderSlot(t.$slots,"default")])):e.createCommentVNode("",!0)}}),y=e.defineComponent({__name:"SuggestionInput",props:{modelValue:{default:""}},emits:["update:modelValue","enter"],setup(r,{emit:n}){const t=r,{selectedItem:o,openBox:d,closeBox:g,selectItem:m,next:f,prev:a}=h(),i=e.ref(),x=p=>{o.value||n("enter",p),i.value&&i.value.blur(),m()},I=e.computed({get:()=>t.modelValue,set:p=>n("update:modelValue",p)});return(p,s)=>e.withDirectives((e.openBlock(),e.createElementBlock("input",{type:"search",class:"suggestion-input","onUpdate:modelValue":s[0]||(s[0]=u=>e.isRef(I)?I.value=u:null),onKeydown:[s[1]||(s[1]=e.withKeys(e.withModifiers(u=>x(u),["prevent"]),["enter"])),s[2]||(s[2]=e.withKeys(e.withModifiers(u=>e.unref(f)(),["prevent"]),["down"])),s[3]||(s[3]=e.withKeys(e.withModifiers(u=>e.unref(a)(),["prevent"]),["up"])),s[4]||(s[4]=e.withKeys(u=>e.unref(g)(),["tab"]))],onFocus:s[5]||(s[5]=(...u)=>e.unref(d)&&e.unref(d)(...u)),ref_key:"inputEl",ref:i},null,544)),[[e.vModelText,e.unref(I)]])}}),b={name:"SuggestionItem"},S=e.defineComponent({...b,emits:["pick","select"],setup(r,{emit:n}){const t=e.ref(null),{addItem:o,removeItem:d,closeBox:g,selectedItem:m}=h();e.getCurrentInstance();const f=()=>{g(),n("pick")},a=()=>{n("select")},i=e.reactive({index:0,pick:f,select:a}),x=e.computed(()=>m.value===i);return e.onMounted(()=>{!t.value||o(t.value,i)}),e.onBeforeUnmount(()=>{!t.value||d(t.value)}),(I,p)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["suggestion-item",{selected:e.unref(x)}]),onClick:p[0]||(p[0]=s=>f()),ref_key:"element",ref:t},[e.renderSlot(I.$slots,"default",{index:i.index})],2))}}),M={SearchBox:_,Input:y,Item:S,Box:w};c.Box=w,c.Input=y,c.Item=S,c.SearchBox=_,c.default=M,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
